<div class="modal-dialog modal-lg" id="editlaborder">
  <div class="modal-content editordermodel">
    <div class="modal-header" style="margin-left:-1px;">
      <p class="modal-title Roboto-medium">Add Lab Results</p>
      <span type="button" class="cross-mark" data-bs-dismiss="modal" aria-label="Close" (click)="cancel()">
        X
      </span>
    </div>
    <div class="modal-body">
      <div class="patient-block">
        <div class="row">
          <div class="col-md-4">
            <mat-label>Patient Name:</mat-label>
            <mat-form-field appearance="outline" class="col-md-12">
              <input matInput placeholder="" disabled class="notallowed-cursor" [(ngModel)]="labandImaging.PatientName">
            </mat-form-field>
          </div>
          <div class="col-md-4">
            <mat-label>Patient ID:</mat-label>
            <mat-form-field appearance="outline" class="col-md-12 ">
              <input matInput placeholder="" disabled class="notallowed-cursor" [ngModel]="labandImaging.PatientId">
            </mat-form-field>
          </div>
          <div class="col-md-4">
            <mat-label>Phone:</mat-label>
            <mat-form-field appearance="outline" class="col-md-12">
              <input matInput placeholder="" disabled class="notallowed-cursor"
                [ngModel]="labandImaging.CurrentPatient.MobilePhone">
            </mat-form-field>
          </div>

        </div>
        <div class="row">
          <div class="col-md-6 col-lg-6">
            <div class="row">
              <div class="col-lg-6 col-md-12">
                <mat-label>Date of birth:</mat-label>
                <mat-form-field appearance="outline" class="col-md-12">
                  <input matInput placeholder="" disabled class="notallowed-cursor"
                    [ngModel]="labandImaging.CurrentPatient.Dob | date:'MM-dd-yyyy'">
                </mat-form-field>
              </div>
              <div class="col-lg-3 col-md-6">
                <mat-label>Sex:</mat-label>
                <mat-form-field appearance="outline" class="col-md-12">
                  <input matInput placeholder="" disabled class="notallowed-cursor"
                    [ngModel]="labandImaging.CurrentPatient.Gender">
                </mat-form-field>
              </div>
              <div class="col-lg-3 col-md-6">
                <mat-label>Age:</mat-label>
                <mat-form-field appearance="outline" class="col-md-12">
                  <input matInput placeholder="" disabled class="notallowed-cursor"
                    [ngModel]="labandImaging.CurrentPatient.Age">
                </mat-form-field>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <mat-label>Fasting:</mat-label>
            <mat-form-field appearance="outline" class="col-md-12">
              <input matInput placeholder="" [(ngModel)]="labandImaging.LabResult.Fasting">
            </mat-form-field>

          </div>
        </div>
        <div class="row">
          <div class="col-md-5">
            <mat-label>Created:</mat-label>
            <mat-form-field appearance="outline" class="col-md-12">
              <input matInput placeholder="" disabled class="notallowed-cursor"
                [ngModel]="labandImaging.CreatedDate | date:'MM-dd-yyyy'">
            </mat-form-field>

          </div>
        </div>
      </div>

      <!-- <div class="row">
        <mat-label>Select Order:</mat-label>
        <div class="thead">
          <div class="Helvetica-sans-serif-medium col-1 th"></div>
          <div class="Helvetica-sans-serif-medium col-1 th">#</div>
          <div class="Helvetica-sans-serif-medium col-2 th">Name</div>
          <div class="Helvetica-sans-serif-medium col-2 th">Order Status</div>
          <div class="Helvetica-sans-serif-medium col-2 th">Ordering Facility</div>
          <div class="Helvetica-sans-serif-medium col-2 th">Scheduled At</div>
          <div class="Helvetica-sans-serif-medium col-2 th">Created At</div>
        </div>
        <div class="tbody" *ngFor="let item of labOrders">
          <div class="Helvetica-sans-serif-medium col-1 td">
            <mat-radio-button [checked]="item.LabProcedureId == labandImaging.LabProcedureId"></mat-radio-button>
          </div>
          <div class="Helvetica-sans-serif-medium col-1 td">{{item.OrderNumber}}</div>
          <div class="Helvetica-sans-serif-medium col-2 td">{{item.LabName}}</div>
          <div class="Helvetica-sans-serif-medium col-2 td">{{item.OrderStatus}}</div>
          <div class="Helvetica-sans-serif-medium col-2 td">{{item.OrderingFacility}}</div>
          <div class="Helvetica-sans-serif-medium col-2 td">{{item.ScheduledAt | date:"MM-dd-yyyy"}}</div>
          <div class="Helvetica-sans-serif-medium col-2 td">{{item.CreatedDate | date:"MM-dd-yyyy"}}</div>
        </div>
      </div> -->

      <div class="scrollable-table order mt-2">
      <mat-label>Select Order:</mat-label>
      <table class="order-table">
        <thead>
          <tr>
            <th></th>
            <th>#</th>
            <th>Name</th>
            <th>Order Status</th>
            <th>Ordering Facility</th>
            <th>Scheduled At</th>
            <th>Created At</th>
          </tr>
        </thead>
        <tbody>
          <tr  *ngFor="let item of labOrders">
            <td>
              <mat-radio-button [checked]="item.LabProcedureId == labandImaging.LabProcedureId"></mat-radio-button>
            </td>
            <td>{{item.OrderNumber}}</td>
            <td>{{item.LabName}}</td>
            <td>{{item.OrderStatus}}</td>
            <td>{{item.OrderingFacility}}</td>
            <td>{{item.ScheduledAt | date:"MM-dd-yyyy"}}</td>
            <td>{{item.CreatedDate | date:"MM-dd-yyyy"}}</td>
          </tr>
        </tbody>
      </table>
    </div>

      <div class="row mt-1">
        <div class="col-lg-9 col-md-12">
          <div class="row">
            <div class="col-md-6">
              <mat-label>Specimen #:</mat-label>
              <mat-form-field appearance="outline" class="col-md-12">
                <input matInput placeholder="" [(ngModel)]="labandImaging.LabResult.Specimen">
              </mat-form-field>
            </div>
            <div class="col-md-6">
              <mat-label>Specimen Type:</mat-label>
              <mat-form-field appearance="outline" class="col-md-12">
                <input matInput placeholder="" [(ngModel)]="labandImaging.LabResult.SpecimenType">
              </mat-form-field>
            </div>
          </div>
        </div>

        <div class="col-lg-3 col-md-12">
          <mat-label class="required">Test Report Date:</mat-label>
          <mat-form-field appearance="outline" class="calendaricon green-calendar col-md-12">
            <input matInput [matDatepicker]="testReportedDate" placeholder="Test Report Date"
              (click)="testReportedDate?.open()" class="Helvetica-sans-serif-medium pointer" readonly
              [(ngModel)]="labandImaging.LabResult.TestReportedDate">
            <mat-datepicker-toggle matSuffix [for]="testReportedDate">
            </mat-datepicker-toggle>
            <mat-datepicker #testReportedDate></mat-datepicker>
          </mat-form-field>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-8 col-md-12">
          <div class="row">
            <div class="col-md-7">
              <mat-label class="required">Ordering Physician:</mat-label>
              <mat-form-field appearance="outline" class="col-md-12">
                <mat-select required placeholder="" [(ngModel)]="labandImaging.LabResult.ProviderId"
                (selectionChange)="updateNPI($event)">
                  <mat-option value='' selected>View All Providers</mat-option>
                  <mat-option *ngFor="let provider of practiceProviders" [value]="provider.ProviderId">
                    {{provider.FullName}}</mat-option>
                </mat-select>
              </mat-form-field>
            </div>
            <div class="col-md-5">
              <mat-label>NPI:</mat-label>
              <mat-form-field appearance="outline" class="col-md-12">
                <input matInput placeholder="" disabled class="notallowed-cursor"
                  [(ngModel)]="labandImaging.LabResult.NPI">

              </mat-form-field>
            </div>
          </div>
        </div>

        <div class="col-lg-4 col-md-12">
          <mat-label class="required">Lab/Imaging Status:</mat-label>
          <mat-form-field appearance="outline" class="col-md-12 orderddhover">
            <mat-select required placeholder="Status" [(ngModel)]="labandImaging.ResultStatus">
              <mat-option *ngFor="let item of ResultStatuses" [value]="item.Value">
                {{item.Name}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>
      <div class="row highlight-blocks">
        <div class="col-lg-7 col-md-12 left-block">

          <div class="row highlight-block">
            <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-12">
                  <p class="title">Ordering Facility Name:</p>
                  <div class="row">
                    <div class="col-lg-12">
                      <mat-form-field appearance="outline" class="col-md-12">
                        <input matInput placeholder="" [(ngModel)]="labandImaging.LabResult.OrderName">
                      </mat-form-field>
                    </div>
                  </div>
                </div>
              </div>
              <div class=" row">
                <div class="col-lg-12 row-content">
                  <p class="title">Ordering Facility Address:</p>
                  <div class="row">
                    <div class="col-lg-12">
                      <mat-form-field appearance="outline" class="col-md-12">
                        <input matInput placeholder="" [(ngModel)]="labandImaging.LabResult.OrderAddress">
                      </mat-form-field>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row highlight-block">
            <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-12">
                  <p class="title">Performing Facility Name:</p>
                  <div class="row">
                    <div class="col-lg-12">
                      <mat-form-field appearance="outline" class="col-md-12">
                        <input matInput placeholder="" [(ngModel)]="labandImaging.LabResult.PerformingName">
                      </mat-form-field>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-lg-12 row-content">
                  <p class="title">Performing Facility Address:</p>
                  <div class="row">
                    <div class="col-lg-12">
                      <mat-form-field appearance="outline" class="col-md-12">
                        <input matInput placeholder="" [(ngModel)]="labandImaging.LabResult.PerformingAddress">
                      </mat-form-field>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-lg-5 col-md-12 right-block">
          <div class="row highlight-block">
            <p class="title">Specimen Collected:</p>
            <div class="col-md-7">
              <mat-form-field appearance="outline" class="calendaricon green-calendar col-md-12">
                <input matInput [matDatepicker]="specimenCollected" placeholder="Specimen Collected Date"
                  (click)="specimenCollected?.open()" class="Helvetica-sans-serif-medium pointer" readonly
                  [(ngModel)]="labandImaging.LabResult.CollectedDate">
                <mat-datepicker-toggle matSuffix [for]="specimenCollected">
                </mat-datepicker-toggle>
                <mat-datepicker #specimenCollected></mat-datepicker>
              </mat-form-field>
            </div>
            <div class="col-md-5">
              <div class="input-group input-group-green input-group-time">
                <mat-form-field appearance="outline" class="col-lg-12 col-md-12 col-12">
                  <input matInput type="text" hint="12 hours format" appTimeMask
                    [(ngModel)]="labandImaging.LabResult.CollectedTime">
                </mat-form-field>
              </div>
            </div>
          </div>
          <div class="row highlight-block">
            <p class="title">Specimen Received:</p>
            <div class="col-md-7">
              <mat-form-field appearance="outline" class="calendaricon green-calendar col-md-12">
                <input matInput [matDatepicker]="specimenReceived" placeholder="Specimen Received Date"
                  (click)="specimenReceived?.open()" class="Helvetica-sans-serif-medium pointer" readonly
                  [(ngModel)]="labandImaging.LabResult.ReceivedDate">
                <mat-datepicker-toggle matSuffix [for]="specimenReceived">
                </mat-datepicker-toggle>
                <mat-datepicker #specimenReceived></mat-datepicker>
              </mat-form-field>
            </div>
            <div class="col-md-5">
              <div class="input-group input-group-green input-group-time">
                <mat-form-field appearance="outline" class="col-lg-12 col-md-12 col-12">
                  <input matInput type="text" hint="12 hours format" appTimeMask
                    [(ngModel)]="labandImaging.LabResult.ReceivedTime">
                </mat-form-field>
              </div>
            </div>
          </div>
          <div class="row highlight-block">
            <p class="title">Test Performed:</p>
            <div class="col-md-7">
              <mat-form-field appearance="outline" class="calendaricon green-calendar col-md-12">
                <input matInput [matDatepicker]="testPerfomred" placeholder="Test Performed Date"
                  (click)="testPerfomred?.open()" class="Helvetica-sans-serif-medium pointer" readonly
                  [(ngModel)]="labandImaging.LabResult.TestedDate">
                <mat-datepicker-toggle matSuffix [for]="testPerfomred">
                </mat-datepicker-toggle>
                <mat-datepicker #testPerfomred></mat-datepicker>
              </mat-form-field>
            </div>
            <div class="col-md-5">
              <div class="input-group input-group-green input-group-time">
                <mat-form-field appearance="outline" class="col-lg-12 col-md-12 col-12">
                  <input matInput type="text" hint="12 hours format" appTimeMask
                    [(ngModel)]="labandImaging.LabResult.TestedTime">
                </mat-form-field>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-12">
          <div class="form-group scrollable-panel">
            <div class="panel panel-tests">
              <div class="panel-heading">
                <div class="title">Tests Ordered (minimum one test order is required)</div>
                <div class="title-right">
                  <button class="plusicon" type="button" aria-expanded="false" (click)="addTestOrder()">
                    <i class="fa fa-plus"></i>
                  </button>
                </div>
              </div>
              <div class="row header-row">
                <div class="col-2 Helvetica-sans-serif-medium" matTooltip="Click the + icon to add Test Code">
                  Code
                </div>
                <div class="col-3  Helvetica-sans-serif-medium">
                  Test
                </div>
                <div class="col-2 Helvetica-sans-serif-medium">
                  Result
                </div>
                <div class="col-1 Helvetica-sans-serif-medium">
                  Units
                </div>
                <div class="col-1 Helvetica-sans-serif-medium">
                  Flag
                </div>
                <div class="col-2 Helvetica-sans-serif-medium">
                  Range
                </div>
                <div class="col-1 Helvetica-sans-serif-medium">
                  Destroy
                </div>
              </div>
              <div class="row">
                <form [formGroup]="formGroups" style="clear: both;">
                  <div formArrayName="testOrders" class="row">
                    <div *ngFor="let atta of testOrders.controls; let i=index ">
                      <div [formGroupName]="i">
                        <div class="row  data-row">
                          <div class="col-2 Helvetica-sans-serif-medium">
                            <input matInput placeholder="" [data-index]="i" matTooltip="Enter minimum three digits"
                              formControlName="Code" (blur)="getCodeInfo($event,i)" />
                          </div>
                          <div class="col-3 Helvetica-sans-serif-medium">
                            <input matInput placeholder="" formControlName="Test"
                              [matTooltip]="atta.controls.Test.value " readonly class="not-allowed"/>
                          </div>
                          <div class="col-2 Helvetica-sans-serif-medium">
                            <input matInput placeholder="" formControlName="Result"
                              [matTooltip]="atta.controls.Result.value " class="not-allowed" />
                          </div>
                          <div class="col-1 Helvetica-sans-serif-medium">
                            <input matInput placeholder="" formControlName="Units"
                              [matTooltip]="atta.controls.Units.value " class="not-allowed" />
                          </div>
                          <div class="col-1 Helvetica-sans-serif-medium">
                            <input matInput placeholder="" formControlName="Flag"
                              [matTooltip]="atta.controls.Flag.value " class="not-allowed" />
                          </div>
                          <div class="col-2 Helvetica-sans-serif-medium">
                            <input matInput placeholder="" formControlName="Range"
                              [matTooltip]="atta.controls.Range.value " class="not-allowed" />
                            <input type="hidden" formControlName="TestOrderId">
                          </div>
                          <div class="col-1 Helvetica-sans-serif-medium" style="display:inherit">
                            <button class="minuicon" type="button" aria-expanded="false" (click)="removeLabOrder(i)">
                              <i class="fa fa-minus"></i>
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </form>
              </div>
              <div class="clearfix d-block w-100"></div>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
      </div>
      <div class="clearfix d-block w-100"></div>
      <div class="row mt-1">
        <div class="col-md-12">
          <mat-label>Notes:</mat-label>
          <textarea matInput class="text-border" placeholder="" [(ngModel)]="labandImaging.LabResult.Notes"></textarea>
        </div>
      </div>

    </div>
    <div class="modal-footer">
      <div class="chk-reviewed" style="float:left">
        <mat-checkbox disabled="true">
        </mat-checkbox>
        <span class="mt-3">Reviewed</span>
      </div>
      <div class="buttons" style="float:right">
        <button mat-raised-button type="submit" class="btn btn-green   pull-right">Print</button>
        <button mat-raised-button type="submit" class="btn btn-green   pull-right"
          *ngIf="!labandImaging.Signed" [disabled]="!labandImaging.LabResult.TestReportedDate" (click)="save(true)">Sign</button>
        <button mat-raised-button type="submit" class="btn btn-green   pull-right" (click)="save(false)"
          *ngIf="!saveClicked && !labandImaging.Signed" [disabled]="!labandImaging.LabResult.TestReportedDate">Save</button>
      </div>
    </div>
  </div>
</div>
